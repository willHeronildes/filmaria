{"ast":null,"code":"import _regeneratorRuntime from\"/home/wivison/filmaria/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/wivison/filmaria/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/wivison/filmaria/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useEffect,useState}from'react';import'./filme-info.css';import{useParams,useHistory}from'react-router-dom';import{toast}from'react-toastify';import api from'../../services/api';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Filme(){var _useParams=useParams(),id=_useParams.id;var history=useHistory();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),filme=_useState2[0],setFilme=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),contador=_useState6[0],setContador=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),print=_useState8[0],setPrint=_useState8[1];useEffect(function(){function loadFilme(){return _loadFilme.apply(this,arguments);}function _loadFilme(){_loadFilme=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return api.get(\"r-api/?api=filmes/\".concat(id));case 2:response=_context.sent;if(!(response.data.length===0)){_context.next=6;break;}//tentou acessar com id que não existe, navego para home!\nhistory.replace('/');return _context.abrupt(\"return\");case 6:setFilme(response.data);setLoading(false);case 8:case\"end\":return _context.stop();}}},_callee);}));return _loadFilme.apply(this,arguments);}loadFilme();return function(){console.log('COMPONENTE DESMONTADO');};},[history,id]);function salvaFilme(){var minhaLista=localStorage.getItem('filmes');var filmesSalvos=JSON.parse(minhaLista)||[];// se tiver algum filme salvo com esse mesmo id precisa ignorar..\nvar hasFilme=filmesSalvos.some(function(filmeSalvo){return filmeSalvo.id===filme.id;});if(hasFilme){toast.error('Você já possui esse filme salvo.');return;}filmesSalvos.push(filme);localStorage.setItem('filmes',JSON.stringify(filmesSalvos));toast.success('Filme salvo com sucesso!');}if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"filme-info\",children:/*#__PURE__*/_jsx(\"h1\",{children:\"Carregando seu Filme...\"})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"filme-info\",children:[/*#__PURE__*/_jsxs(\"h1\",{children:[\" \",filme.nome,\" \"]}),/*#__PURE__*/_jsx(\"img\",{src:filme.foto,alt:filme.nome}),/*#__PURE__*/_jsx(\"h3\",{children:\"Sinopse\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\" \",filme.sinopse,\" \"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"botoes\",children:[/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(\"a\",{target:\"_blank\",href:\"https://youtube.com/results?search_query=\".concat(filme.nome,\" Trailer\"),children:\"Trailer\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"btn-add\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Selecione quantos deseja salvar\"}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return setContador(contador-1);},children:\" - \"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"cont\",name:\"cont\",value:contador}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return setContador(contador+1);},children:\" + \"}),/*#__PURE__*/_jsx(\"button\",{onClick:salvaFilme,children:\"Salvar\"})]}),/*#__PURE__*/_jsx(\"form\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"button\",value:\"IMPRIMIR\",onClick:function onClick(){return setPrint(window.print);}})})]})]});}","map":{"version":3,"sources":["/home/wivison/filmaria/src/pages/Filme/index.js"],"names":["useEffect","useState","useParams","useHistory","toast","api","Filme","id","history","filme","setFilme","loading","setLoading","contador","setContador","print","setPrint","loadFilme","get","response","data","length","replace","console","log","salvaFilme","minhaLista","localStorage","getItem","filmesSalvos","JSON","parse","hasFilme","some","filmeSalvo","error","push","setItem","stringify","success","nome","foto","sinopse","window"],"mappings":"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","sourcesContent":["\nimport { useEffect, useState } from 'react';\nimport './filme-info.css';\nimport { useParams, useHistory } from 'react-router-dom';\nimport { toast } from 'react-toastify';\nimport api from '../../services/api';\n\n\nexport default function Filme(){\n   const { id } = useParams();\n   const history = useHistory();\n   const [filme, setFilme] = useState([]);\n   const [loading, setLoading] = useState(true);\n   const [contador, setContador] = useState(0);\n   const [print, setPrint] = useState ();\n\n   useEffect(()=>{\n       async function loadFilme(){\n           const response = await api.get(`r-api/?api=filmes/${id}`);\n\n           if(response.data.length === 0){\n               //tentou acessar com id que não existe, navego para home!\n               history.replace('/');\n               return;\n           }\n\n           setFilme(response.data);\n           setLoading(false);\n       }\n\n       loadFilme();\n\n       return() => {\n          console.log('COMPONENTE DESMONTADO');\n       }\n\n   }, [history, id]);\n\n   function salvaFilme(){\n\n     const minhaLista = localStorage.getItem('filmes');\n\n     let filmesSalvos = JSON.parse(minhaLista) || [];\n\n     // se tiver algum filme salvo com esse mesmo id precisa ignorar..\n\n     const hasFilme = filmesSalvos.some((filmeSalvo)=> filmeSalvo.id === filme.id)\n\n     if(hasFilme){\n         toast.error('Você já possui esse filme salvo.');\n         return;\n     }\n\n     filmesSalvos.push(filme);\n     localStorage.setItem('filmes', JSON.stringify(filmesSalvos));\n     toast.success('Filme salvo com sucesso!');\n\n   }\n\n   if(loading){\n       return(\n           <div className=\"filme-info\">\n               <h1>Carregando seu Filme...</h1>\n           </div>\n       )\n   }\n\n    return(\n        <div className=\"filme-info\">\n           <h1> {filme.nome} </h1>\n           <img src={filme.foto} alt={filme.nome} />\n           <h3>Sinopse</h3>\n           <p> {filme.sinopse} </p>\n\n           <div className=\"botoes\">\n               <button>\n                   <a target=\"_blank\" href={`https://youtube.com/results?search_query=${filme.nome} Trailer`}>\n                     Trailer  \n                   </a>\n               </button>\n               <div className=\"btn-add\">\n                  <h3>Selecione quantos deseja salvar</h3>\n                  <button onClick={()=> setContador(contador - 1)}> - </button>\n                  <input type=\"text\" id=\"cont\" name=\"cont\" value={contador}></input>\n                  <button onClick={()=> setContador(contador + 1)}> + </button>\n                  <button onClick={salvaFilme} >Salvar</button>\n               </div>\n               <form>\n                      <input type=\"button\" value=\"IMPRIMIR\" onClick={()=> setPrint(window.print)}/>\n               </form>\n           </div>    \n        </div>\n    );\n}"]},"metadata":{},"sourceType":"module"}